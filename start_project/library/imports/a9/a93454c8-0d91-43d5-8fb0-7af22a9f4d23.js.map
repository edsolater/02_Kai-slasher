{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\player.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","setJumpAction","jumpUp","moveBy","v2","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","repeatForever","sequence","onKeyDown","event","keyCode","macro","KEY","a","accLeft","d","accRight","onKeyUp","update","dt","xSpeed","Math","abs","sign","node","x","onLoad","jumpAction","runAction","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","onDestroy","off"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    // 主角跳跃高度\r\n    jumpHeight: 0,\r\n    // 主角跳跃持续时间\r\n    jumpDuration: 0,\r\n    // 最大移动速度\r\n    maxMoveSpeed: 0,\r\n    // 加速度\r\n    accel: 0,\r\n\r\n  },\r\n\r\n  setJumpAction() {\r\n    // 跳跃上升\r\n    const jumpUp = cc\r\n      .moveBy(this.jumpDuration, cc.v2(0, this.jumpHeight))\r\n      .easing(cc.easeCubicActionOut());\r\n    // 下落\r\n    const jumpDown = cc\r\n      .moveBy(this.jumpDuration, cc.v2(0, -this.jumpHeight))\r\n      .easing(cc.easeCubicActionIn());\r\n    // 不断重复\r\n    return cc.repeatForever(cc.sequence(jumpUp, jumpDown));\r\n  },\r\n\r\n  onKeyDown(event) {\r\n    // set a flag when key pressed\r\n    switch (event.keyCode) {\r\n      case cc.macro.KEY.a:\r\n        this.accLeft = true;\r\n        break;\r\n      case cc.macro.KEY.d:\r\n        this.accRight = true;\r\n        break;\r\n    }\r\n  },\r\n\r\n  onKeyUp(event) {\r\n    // unset a flag when key released\r\n    switch (event.keyCode) {\r\n      case cc.macro.KEY.a:\r\n        this.accLeft = false;\r\n        break;\r\n      case cc.macro.KEY.d:\r\n        this.accRight = false;\r\n        break;\r\n    }\r\n  },\r\n\r\n  update(dt) {\r\n    // 根据当前加速度方向每帧更新速度\r\n    if (this.accLeft) {\r\n      this.xSpeed -= this.accel * dt;\r\n    } else if (this.accRight) {\r\n      this.xSpeed += this.accel * dt;\r\n    }\r\n    // 限制主角的速度不能超过最大值\r\n    if (Math.abs(this.xSpeed) > this.maxMoveSpeed) {\r\n      // if speed reach limit, use max speed with current direction\r\n      this.xSpeed = this.maxMoveSpeed * Math.sign(this.xSpeed);\r\n    }\r\n\r\n    // 根据当前速度更新主角的位置\r\n    this.node.x += this.xSpeed * dt;\r\n  },\r\n\r\n  onLoad() {\r\n    // 初始化跳跃动作\r\n    this.jumpAction = this.setJumpAction();\r\n    this.node.runAction(this.jumpAction);\r\n\r\n    // 加速度方向开关\r\n    this.accLeft = false;\r\n    this.accRight = false;\r\n    // 主角当前水平方向速度\r\n    this.xSpeed = 0;\r\n\r\n    // 初始化键盘输入监听\r\n    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n  },\r\n\r\n  onDestroy() {\r\n    // 取消键盘输入监听\r\n    cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n  }\r\n});\r\n"]}